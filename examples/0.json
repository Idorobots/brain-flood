{
    "server" : {
    	"host" : "localhost",
	"port" : 8080,
	"endpoint" : "/socket.io/1/",

	"metadata" : {
	    "hb_timeout" : 17000,
	    "ping_timeout" : 5000
	}
    },
    
    "phases" : [
    	{
	    "name" : "Sample Phase",
	    "users" : 10,
	    "start_time" : 1000,
	    "duration" : 1000,
	    "user_sessions" : ["Sample WebSocket Session", "Sample XHR-polling Session"],

	    "metadata" : { }
	}
    ],
    
    "sessions" : [
	{
	    "name" : "Sample WebSocket Session",
	    "transport" : "websocket",
	    "weight" : 0.8,

	    "metadata" : {
		"event" : "ping",
		"args" : "WebSocket"
	    },

	    "do" : [
		["on_socketio", {"opcode" : "1", "do" : [
		    ["start_timer", {"name" : "ping", "time" : "$ping_timeout"}]
		]}],

		["on_timeout", {"name" : "ping", "do" : [
		    ["log", {"format" : "~s pinged!", "values" : ["$args"]}],
		    ["inc", {"name" : "sent"}],
		    ["emit_event", {"name" : "$event", "args" : "$args"}]
		]}],

		["on_socketio", {"opcode" : "5", "do" : [
		    ["inc", {"name" : "received"}],
		    ["match", {"re" : "{.*}", "subject" : "$message.data", "on_match" : [
		    	["log", {"format" : "Received event ~s via ~s.", "values" : ["$match_0", "$args"]}]
		    ]}]
		]}]
	    ]
	},
	{
	    "name" : "Sample XHR-polling Session",
	    "transport" : "xhr_polling",
	    "weight" : 0.2,

	    "metadata" : {
		"event" : "ping",
		"args" : "XHR-polling"
	    },

	    "inherits" : ["Sample WebSocket Session"],
	    "do" : []
	}
	
    ]
}